mod tls;
mod nsm;

pub use tls::{ring_key_gen_pcks_8, gen_ecc_cert, create_cert_and_prikey,parse_payload_from_cert};

#[cfg(all(feature = "openssl"))]
pub use nitro_enclave_attestation_document::AttestationDocument;

use nsm_io::{Request, Response, AttestationDoc};
use serde_bytes::ByteBuf;

use serde::{Deserialize, Serialize};
use serde_cbor::error::Error as CborError;
use serde_cbor::{from_slice, to_vec};

use webpki;
use base64;

use std::io::BufReader;
use std::time::SystemTime;

// use nitro_enclave_attestation_document;

pub fn get_remote_attestation() -> Option<Response> {
    let nsm_fd = nsm_driver::nsm_init();

    let public_key = ByteBuf::from("my super secret key");
    let hello = ByteBuf::from("hello, world!");
    let nonce = ByteBuf::from("1");

    let request = Request::Attestation {
        public_key: Some(public_key),
        user_data: Some(hello),
        nonce: Some(nonce),
    };

    let response = nsm_driver::nsm_process_request(nsm_fd, request);
    println!("====response======");
    println!("{:?}", to_vec(&response).unwrap());
    println!("==========");

    nsm_driver::nsm_exit(nsm_fd);

    let document = resolve_the_response_doc(response).unwrap();
    println!("====document======");
    println!("{:?}", to_vec(&document).unwrap());
    println!("==========");

    None
}

pub fn resolve_the_response_doc(response:Response) -> Result<Vec<u8>,String> {
    let document = match response {
        Response::Attestation { document } => { document },
        _ => { return Err("the response is not Attestation".to_string()); },
    };

    Ok(document)
}

pub fn resolve_the_response(response:Response) -> Result<Vec<u8>,String> {
    let document = match response {
        Response::Attestation { document } => { document },
        _ => { return Err("the response is not Attestation".to_string()); },
    };

    let data: AttestationDoc = serde_cbor::from_slice(&document).unwrap();
    let certificate = data.certificate.into_vec();

    Ok(certificate)
}

pub fn verify_the_certificate(){
}

pub const CA : &[u8] = include_bytes!("root.pem");
type SignatureAlgorithms = &'static [&'static webpki::SignatureAlgorithm];
static SUPPORTED_SIG_ALGS: SignatureAlgorithms = &[
    &webpki::ECDSA_P256_SHA256,
    &webpki::ECDSA_P256_SHA384,
    &webpki::ECDSA_P384_SHA256,
    &webpki::ECDSA_P384_SHA384,
    &webpki::RSA_PSS_2048_8192_SHA256_LEGACY_KEY,
    &webpki::RSA_PSS_2048_8192_SHA384_LEGACY_KEY,
    &webpki::RSA_PSS_2048_8192_SHA512_LEGACY_KEY,
    &webpki::RSA_PKCS1_2048_8192_SHA256,
    &webpki::RSA_PKCS1_2048_8192_SHA384,
    &webpki::RSA_PKCS1_2048_8192_SHA512,
    &webpki::RSA_PKCS1_3072_8192_SHA384,
];

pub fn verify_cert(sig_raw:Vec<u8>, sig_cert_raw:Vec<u8>, attn_report_raw:Vec<u8>){

    let sig = base64::decode(&sig_raw).unwrap();
    let sig_cert_dec = base64::decode_config(&sig_cert_raw, base64::MIME).unwrap();
    let sig_cert = webpki::EndEntityCert::from(&sig_cert_dec).expect("Bad DER");

    let mut ias_ca_stripped = CA.to_vec();
    ias_ca_stripped.retain(|&x| x != 0x0d && x != 0x0a);
    let head_len = "-----BEGIN CERTIFICATE-----".len();
    let tail_len = "-----END CERTIFICATE-----".len();
    let full_len = ias_ca_stripped.len();
    let ias_ca_core : &[u8] = &ias_ca_stripped[head_len..full_len - tail_len];
    let ias_cert_dec = base64::decode_config(ias_ca_core, base64::MIME).unwrap();

    let mut ca_reader = BufReader::new(&CA[..]);

    let mut root_store = rustls::RootCertStore::empty();
    root_store.add_pem_file(&mut ca_reader).expect("Failed to add CA");

    let trust_anchors: Vec<webpki::TrustAnchor> = root_store
        .roots
        .iter()
        .map(|cert| cert.to_trust_anchor())
        .collect();

    let mut chain:Vec<&[u8]> = Vec::new();
    chain.push(&ias_cert_dec);

    let now_func = webpki::Time::try_from(SystemTime::now());

    match sig_cert.verify_is_valid_tls_server_cert(
        SUPPORTED_SIG_ALGS,
        &webpki::TLSServerTrustAnchors(&trust_anchors),
        &chain,
        now_func.unwrap()) {
        Ok(_) => println!("Cert is good"),
        Err(e) => println!("Cert verification error {:?}", e),
    }

    // Verify the signature against the signing cert
    match sig_cert.verify_signature(
        &webpki::RSA_PKCS1_2048_8192_SHA256,
        &attn_report_raw,
        &sig) {
        Ok(_) => println!("Signature good"),
        Err(e) => {
            println!("Signature verification error {:?}", e);
            panic!();
        },
    }

}



#[test]
fn asd(){
    let a = [161u8, 107, 65, 116, 116, 101, 115, 116, 97, 116, 105, 111, 110, 161, 104, 100, 111, 99, 117, 109, 101, 110, 116, 89, 17, 76, 132, 68, 161, 1, 56, 34, 160, 89, 16, 224, 169, 105, 109, 111, 100, 117, 108, 101, 95, 105, 100, 120, 39, 105, 45, 48, 98, 48, 54, 54, 55, 55, 52, 53, 54, 52, 53, 50, 97, 52, 57, 97, 45, 101, 110, 99, 48, 49, 56, 48, 48, 50, 49, 49, 53, 56, 49, 102, 57, 54, 99, 48, 102, 100, 105, 103, 101, 115, 116, 102, 83, 72, 65, 51, 56, 52, 105, 116, 105, 109, 101, 115, 116, 97, 109, 112, 27, 0, 0, 1, 128, 2, 17, 133, 16, 100, 112, 99, 114, 115, 176, 0, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 88, 48, 153, 126, 50, 58, 85, 60, 31, 208, 251, 37, 130, 65, 183, 62, 232, 198, 129, 242, 230, 7, 27, 138, 182, 211, 4, 212, 49, 2, 192, 147, 255, 5, 2, 44, 236, 238, 59, 64, 6, 89, 209, 252, 78, 49, 4, 175, 1, 156, 5, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 107, 99, 101, 114, 116, 105, 102, 105, 99, 97, 116, 101, 89, 2, 127, 48, 130, 2, 123, 48, 130, 2, 1, 160, 3, 2, 1, 2, 2, 16, 1, 128, 2, 17, 88, 31, 150, 192, 0, 0, 0, 0, 98, 78, 90, 128, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 129, 142, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 57, 48, 55, 6, 3, 85, 4, 3, 12, 48, 105, 45, 48, 98, 48, 54, 54, 55, 55, 52, 53, 54, 52, 53, 50, 97, 52, 57, 97, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 50, 48, 52, 48, 55, 48, 51, 50, 57, 48, 49, 90, 23, 13, 50, 50, 48, 52, 48, 55, 48, 54, 50, 57, 48, 52, 90, 48, 129, 147, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 62, 48, 60, 6, 3, 85, 4, 3, 12, 53, 105, 45, 48, 98, 48, 54, 54, 55, 55, 52, 53, 54, 52, 53, 50, 97, 52, 57, 97, 45, 101, 110, 99, 48, 49, 56, 48, 48, 50, 49, 49, 53, 56, 49, 102, 57, 54, 99, 48, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 113, 4, 169, 115, 217, 245, 116, 216, 100, 205, 205, 134, 236, 33, 26, 4, 161, 178, 244, 254, 164, 23, 33, 20, 50, 158, 165, 195, 21, 8, 176, 123, 81, 75, 245, 230, 200, 4, 227, 127, 180, 195, 174, 161, 252, 191, 222, 231, 231, 49, 18, 2, 163, 215, 131, 188, 52, 70, 60, 173, 96, 19, 245, 70, 211, 144, 80, 16, 57, 86, 177, 178, 106, 164, 114, 159, 248, 217, 220, 222, 235, 136, 37, 171, 138, 154, 162, 37, 17, 88, 182, 197, 255, 60, 238, 142, 163, 29, 48, 27, 48, 12, 6, 3, 85, 29, 19, 1, 1, 255, 4, 2, 48, 0, 48, 11, 6, 3, 85, 29, 15, 4, 4, 3, 2, 6, 192, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 104, 0, 48, 101, 2, 48, 120, 63, 28, 128, 179, 212, 34, 120, 226, 87, 250, 217, 203, 103, 87, 203, 190, 210, 177, 26, 203, 129, 107, 92, 51, 138, 155, 107, 96, 197, 108, 101, 52, 96, 37, 170, 23, 206, 94, 227, 96, 52, 252, 110, 104, 68, 169, 58, 2, 49, 0, 180, 220, 247, 77, 194, 207, 210, 131, 116, 71, 17, 238, 176, 94, 76, 128, 92, 253, 202, 10, 7, 186, 200, 41, 245, 13, 138, 74, 141, 214, 31, 158, 47, 231, 182, 44, 58, 71, 2, 219, 161, 41, 56, 188, 244, 80, 8, 29, 104, 99, 97, 98, 117, 110, 100, 108, 101, 132, 89, 2, 21, 48, 130, 2, 17, 48, 130, 1, 150, 160, 3, 2, 1, 2, 2, 17, 0, 249, 49, 117, 104, 27, 144, 175, 225, 29, 70, 204, 180, 228, 231, 248, 86, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 49, 57, 49, 48, 50, 56, 49, 51, 50, 56, 48, 53, 90, 23, 13, 52, 57, 49, 48, 50, 56, 49, 52, 50, 56, 48, 53, 90, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 252, 2, 84, 235, 166, 8, 193, 243, 104, 112, 226, 154, 218, 144, 190, 70, 56, 50, 146, 115, 110, 137, 75, 255, 246, 114, 217, 137, 68, 75, 80, 81, 229, 52, 164, 177, 246, 219, 227, 192, 188, 88, 26, 50, 183, 177, 118, 7, 14, 222, 18, 214, 154, 63, 234, 33, 27, 102, 231, 82, 207, 125, 209, 221, 9, 95, 111, 19, 112, 244, 23, 8, 67, 217, 220, 16, 1, 33, 228, 207, 99, 1, 40, 9, 102, 68, 135, 201, 121, 98, 132, 48, 77, 197, 63, 244, 163, 66, 48, 64, 48, 15, 6, 3, 85, 29, 19, 1, 1, 255, 4, 5, 48, 3, 1, 1, 255, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 144, 37, 181, 13, 217, 5, 71, 231, 150, 195, 150, 250, 114, 157, 207, 153, 169, 223, 75, 150, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, 163, 127, 47, 145, 161, 201, 189, 94, 231, 184, 98, 124, 22, 152, 210, 85, 3, 142, 31, 3, 67, 249, 91, 99, 169, 98, 140, 61, 57, 128, 149, 69, 161, 30, 188, 191, 46, 59, 85, 216, 174, 238, 113, 180, 195, 214, 173, 243, 2, 49, 0, 162, 243, 155, 22, 5, 178, 112, 40, 165, 221, 75, 160, 105, 181, 1, 110, 101, 180, 251, 222, 143, 224, 6, 29, 106, 83, 25, 127, 156, 218, 245, 217, 67, 188, 97, 252, 43, 235, 3, 203, 111, 238, 141, 35, 2, 243, 223, 246, 89, 2, 194, 48, 130, 2, 190, 48, 130, 2, 68, 160, 3, 2, 1, 2, 2, 16, 72, 89, 143, 129, 178, 119, 228, 126, 214, 78, 90, 102, 147, 77, 205, 244, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 50, 48, 52, 48, 49, 49, 56, 50, 49, 48, 48, 90, 23, 13, 50, 50, 48, 52, 50, 49, 49, 57, 50, 49, 48, 48, 90, 48, 100, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 54, 48, 52, 6, 3, 85, 4, 3, 12, 45, 97, 100, 55, 57, 56, 51, 102, 54, 52, 54, 101, 102, 99, 55, 99, 52, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 208, 176, 163, 110, 108, 115, 193, 184, 155, 197, 161, 174, 37, 82, 77, 197, 158, 196, 54, 39, 223, 172, 156, 226, 57, 60, 56, 30, 176, 3, 79, 117, 148, 80, 101, 50, 56, 194, 72, 20, 57, 171, 234, 82, 102, 139, 209, 66, 80, 48, 205, 251, 163, 58, 73, 170, 97, 246, 50, 184, 254, 49, 211, 31, 133, 236, 20, 207, 4, 99, 124, 220, 244, 154, 253, 36, 217, 235, 7, 189, 240, 88, 74, 242, 224, 175, 12, 92, 81, 1, 27, 152, 47, 183, 129, 97, 163, 129, 213, 48, 129, 210, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 2, 48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, 128, 20, 144, 37, 181, 13, 217, 5, 71, 231, 150, 195, 150, 250, 114, 157, 207, 153, 169, 223, 75, 150, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 28, 10, 15, 237, 31, 28, 72, 150, 205, 213, 166, 69, 32, 119, 83, 121, 17, 152, 115, 78, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 108, 6, 3, 85, 29, 31, 4, 101, 48, 99, 48, 97, 160, 95, 160, 93, 134, 91, 104, 116, 116, 112, 58, 47, 47, 97, 119, 115, 45, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 45, 99, 114, 108, 46, 115, 51, 46, 97, 109, 97, 122, 111, 110, 97, 119, 115, 46, 99, 111, 109, 47, 99, 114, 108, 47, 97, 98, 52, 57, 54, 48, 99, 99, 45, 55, 100, 54, 51, 45, 52, 50, 98, 100, 45, 57, 101, 57, 102, 45, 53, 57, 51, 51, 56, 99, 98, 54, 55, 102, 56, 52, 46, 99, 114, 108, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 104, 0, 48, 101, 2, 48, 106, 211, 175, 216, 63, 62, 72, 73, 142, 39, 121, 20, 33, 222, 223, 121, 151, 134, 7, 117, 20, 112, 132, 242, 57, 91, 150, 26, 127, 95, 156, 166, 76, 83, 190, 152, 41, 202, 223, 254, 123, 26, 30, 167, 82, 105, 215, 9, 2, 49, 0, 209, 82, 146, 16, 174, 248, 20, 169, 13, 77, 209, 69, 211, 88, 4, 29, 45, 240, 37, 222, 205, 84, 166, 4, 78, 54, 161, 163, 31, 0, 58, 192, 174, 36, 38, 160, 251, 212, 36, 232, 153, 238, 0, 197, 58, 112, 93, 171, 89, 3, 25, 48, 130, 3, 21, 48, 130, 2, 154, 160, 3, 2, 1, 2, 2, 17, 0, 222, 148, 242, 104, 194, 226, 150, 194, 227, 115, 158, 147, 231, 19, 174, 123, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 100, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 54, 48, 52, 6, 3, 85, 4, 3, 12, 45, 97, 100, 55, 57, 56, 51, 102, 54, 52, 54, 101, 102, 99, 55, 99, 52, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 50, 48, 52, 48, 54, 49, 49, 53, 50, 52, 57, 90, 23, 13, 50, 50, 48, 52, 49, 50, 48, 48, 53, 50, 52, 56, 90, 48, 129, 136, 49, 59, 48, 57, 6, 3, 85, 4, 3, 12, 50, 49, 56, 97, 51, 54, 97, 49, 50, 57, 98, 56, 51, 99, 97, 55, 46, 122, 111, 110, 97, 108, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 11, 48, 9, 6, 3, 85, 4, 8, 12, 2, 87, 65, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 172, 35, 105, 154, 147, 246, 60, 181, 216, 195, 255, 153, 46, 212, 45, 185, 94, 181, 189, 49, 216, 17, 101, 121, 54, 115, 109, 44, 131, 248, 123, 116, 193, 30, 1, 86, 28, 218, 32, 101, 64, 252, 22, 19, 164, 168, 116, 91, 20, 18, 161, 157, 105, 135, 95, 183, 18, 104, 5, 41, 1, 123, 109, 25, 197, 147, 56, 65, 153, 67, 9, 155, 23, 143, 20, 108, 139, 105, 103, 124, 161, 46, 18, 179, 120, 107, 8, 226, 79, 212, 67, 205, 110, 131, 14, 178, 163, 129, 234, 48, 129, 231, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 1, 48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, 128, 20, 28, 10, 15, 237, 31, 28, 72, 150, 205, 213, 166, 69, 32, 119, 83, 121, 17, 152, 115, 78, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 236, 82, 162, 207, 114, 141, 251, 199, 145, 223, 107, 46, 170, 164, 85, 0, 218, 12, 189, 241, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 129, 128, 6, 3, 85, 29, 31, 4, 121, 48, 119, 48, 117, 160, 115, 160, 113, 134, 111, 104, 116, 116, 112, 58, 47, 47, 99, 114, 108, 45, 117, 115, 45, 101, 97, 115, 116, 45, 50, 45, 97, 119, 115, 45, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 46, 115, 51, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 109, 97, 122, 111, 110, 97, 119, 115, 46, 99, 111, 109, 47, 99, 114, 108, 47, 53, 50, 98, 99, 99, 99, 54, 56, 45, 56, 55, 101, 55, 45, 52, 101, 97, 51, 45, 56, 52, 101, 57, 45, 48, 48, 56, 99, 52, 55, 98, 51, 97, 55, 49, 55, 46, 99, 114, 108, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, 214, 22, 40, 244, 26, 215, 178, 160, 195, 116, 198, 115, 241, 48, 23, 254, 230, 92, 114, 145, 125, 161, 71, 46, 144, 217, 83, 60, 228, 216, 96, 109, 83, 183, 123, 197, 197, 14, 132, 175, 213, 94, 114, 120, 102, 62, 109, 190, 2, 49, 0, 151, 241, 205, 24, 126, 45, 131, 33, 52, 168, 33, 42, 141, 199, 255, 40, 121, 244, 109, 83, 39, 69, 216, 59, 211, 41, 162, 45, 89, 142, 185, 116, 211, 244, 79, 42, 135, 62, 131, 153, 78, 155, 236, 249, 88, 202, 237, 29, 89, 2, 131, 48, 130, 2, 127, 48, 130, 2, 4, 160, 3, 2, 1, 2, 2, 21, 0, 230, 104, 80, 254, 152, 182, 253, 153, 100, 17, 158, 253, 28, 72, 5, 192, 170, 214, 81, 66, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 129, 136, 49, 59, 48, 57, 6, 3, 85, 4, 3, 12, 50, 49, 56, 97, 51, 54, 97, 49, 50, 57, 98, 56, 51, 99, 97, 55, 46, 122, 111, 110, 97, 108, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 11, 48, 9, 6, 3, 85, 4, 8, 12, 2, 87, 65, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 48, 30, 23, 13, 50, 50, 48, 52, 48, 54, 49, 56, 49, 57, 50, 49, 90, 23, 13, 50, 50, 48, 52, 48, 55, 49, 56, 49, 57, 50, 49, 90, 48, 129, 142, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 57, 48, 55, 6, 3, 85, 4, 3, 12, 48, 105, 45, 48, 98, 48, 54, 54, 55, 55, 52, 53, 54, 52, 53, 50, 97, 52, 57, 97, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 134, 243, 71, 0, 28, 58, 163, 83, 12, 233, 154, 127, 192, 39, 88, 185, 172, 215, 71, 77, 95, 234, 251, 24, 224, 172, 218, 219, 201, 76, 220, 140, 75, 158, 185, 40, 166, 53, 16, 8, 133, 152, 33, 217, 78, 220, 100, 108, 21, 131, 228, 237, 138, 172, 62, 92, 81, 177, 91, 110, 125, 37, 247, 251, 6, 96, 77, 102, 35, 46, 52, 222, 242, 48, 244, 190, 166, 36, 76, 20, 150, 183, 77, 8, 190, 148, 68, 167, 57, 31, 33, 3, 19, 130, 71, 22, 163, 38, 48, 36, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 0, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 2, 4, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, 192, 185, 177, 42, 96, 22, 149, 171, 223, 240, 71, 3, 253, 251, 58, 50, 82, 240, 194, 83, 109, 114, 12, 2, 244, 6, 5, 161, 253, 42, 120, 34, 160, 44, 41, 214, 198, 131, 240, 201, 107, 12, 204, 134, 216, 83, 240, 204, 2, 49, 0, 131, 101, 66, 223, 42, 100, 24, 185, 125, 108, 118, 30, 196, 140, 40, 198, 118, 152, 48, 113, 120, 212, 1, 96, 76, 9, 99, 214, 163, 200, 240, 125, 30, 53, 225, 66, 219, 5, 115, 198, 71, 119, 104, 114, 94, 33, 149, 135, 106, 112, 117, 98, 108, 105, 99, 95, 107, 101, 121, 83, 109, 121, 32, 115, 117, 112, 101, 114, 32, 115, 101, 99, 114, 101, 116, 32, 107, 101, 121, 105, 117, 115, 101, 114, 95, 100, 97, 116, 97, 77, 104, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100, 33, 101, 110, 111, 110, 99, 101, 246, 88, 96, 195, 199, 126, 4, 158, 168, 123, 138, 143, 48, 250, 225, 192, 5, 219, 32, 9, 123, 237, 40, 253, 241, 93, 139, 105, 97, 67, 100, 127, 242, 205, 4, 27, 157, 131, 154, 178, 210, 23, 195, 138, 195, 4, 38, 94, 75, 106, 158, 52, 176, 164, 93, 154, 207, 245, 233, 225, 238, 37, 100, 138, 193, 83, 142, 62, 66, 150, 233, 93, 178, 190, 47, 89, 178, 70, 47, 15, 74, 14, 2, 103, 180, 163, 239, 9, 65, 172, 237, 146, 224, 99, 219, 246, 100, 161, 64];
    let b = [161u8, 107, 65, 116, 116, 101, 115, 116, 97, 116, 105, 111, 110, 161, 104, 100, 111, 99, 117, 109, 101, 110, 116, 89, 17, 78, 132, 68, 161, 1, 56, 34, 160, 89, 16, 226, 169, 105, 109, 111, 100, 117, 108, 101, 95, 105, 100, 120, 39, 105, 45, 48, 98, 48, 54, 54, 55, 55, 52, 53, 54, 52, 53, 50, 97, 52, 57, 97, 45, 101, 110, 99, 48, 49, 56, 48, 48, 50, 50, 102, 54, 99, 98, 55, 48, 100, 51, 57, 102, 100, 105, 103, 101, 115, 116, 102, 83, 72, 65, 51, 56, 52, 105, 116, 105, 109, 101, 115, 116, 97, 109, 112, 27, 0, 0, 1, 128, 2, 47, 153, 188, 100, 112, 99, 114, 115, 176, 0, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 88, 48, 153, 126, 50, 58, 85, 60, 31, 208, 251, 37, 130, 65, 183, 62, 232, 198, 129, 242, 230, 7, 27, 138, 182, 211, 4, 212, 49, 2, 192, 147, 255, 5, 2, 44, 236, 238, 59, 64, 6, 89, 209, 252, 78, 49, 4, 175, 1, 156, 5, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 107, 99, 101, 114, 116, 105, 102, 105, 99, 97, 116, 101, 89, 2, 128, 48, 130, 2, 124, 48, 130, 2, 1, 160, 3, 2, 1, 2, 2, 16, 1, 128, 2, 47, 108, 183, 13, 57, 0, 0, 0, 0, 98, 78, 98, 51, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 129, 142, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 57, 48, 55, 6, 3, 85, 4, 3, 12, 48, 105, 45, 48, 98, 48, 54, 54, 55, 55, 52, 53, 54, 52, 53, 50, 97, 52, 57, 97, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 50, 48, 52, 48, 55, 48, 52, 48, 49, 53, 50, 90, 23, 13, 50, 50, 48, 52, 48, 55, 48, 55, 48, 49, 53, 53, 90, 48, 129, 147, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 62, 48, 60, 6, 3, 85, 4, 3, 12, 53, 105, 45, 48, 98, 48, 54, 54, 55, 55, 52, 53, 54, 52, 53, 50, 97, 52, 57, 97, 45, 101, 110, 99, 48, 49, 56, 48, 48, 50, 50, 102, 54, 99, 98, 55, 48, 100, 51, 57, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 126, 122, 217, 62, 255, 83, 169, 184, 169, 91, 90, 226, 31, 242, 60, 42, 190, 214, 144, 41, 1, 34, 235, 184, 178, 15, 10, 239, 70, 111, 113, 137, 166, 125, 225, 52, 86, 167, 39, 229, 80, 40, 137, 155, 253, 222, 166, 134, 206, 4, 182, 157, 186, 109, 177, 153, 111, 111, 4, 233, 109, 249, 235, 6, 41, 246, 159, 13, 190, 40, 211, 49, 44, 149, 124, 204, 167, 231, 37, 199, 84, 72, 157, 32, 238, 140, 186, 110, 246, 188, 77, 75, 203, 222, 45, 43, 163, 29, 48, 27, 48, 12, 6, 3, 85, 29, 19, 1, 1, 255, 4, 2, 48, 0, 48, 11, 6, 3, 85, 29, 15, 4, 4, 3, 2, 6, 192, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, 165, 140, 216, 12, 51, 216, 243, 185, 29, 12, 235, 216, 70, 34, 241, 66, 103, 210, 195, 249, 27, 241, 68, 97, 206, 192, 129, 255, 121, 122, 81, 176, 250, 169, 32, 96, 44, 200, 213, 154, 157, 127, 210, 170, 77, 104, 25, 101, 2, 49, 0, 164, 141, 30, 92, 165, 113, 183, 155, 137, 99, 111, 246, 156, 196, 127, 26, 41, 80, 158, 174, 218, 214, 66, 34, 107, 18, 180, 201, 247, 253, 34, 234, 147, 35, 11, 135, 203, 16, 184, 217, 19, 214, 39, 80, 15, 180, 138, 132, 104, 99, 97, 98, 117, 110, 100, 108, 101, 132, 89, 2, 21, 48, 130, 2, 17, 48, 130, 1, 150, 160, 3, 2, 1, 2, 2, 17, 0, 249, 49, 117, 104, 27, 144, 175, 225, 29, 70, 204, 180, 228, 231, 248, 86, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 49, 57, 49, 48, 50, 56, 49, 51, 50, 56, 48, 53, 90, 23, 13, 52, 57, 49, 48, 50, 56, 49, 52, 50, 56, 48, 53, 90, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 252, 2, 84, 235, 166, 8, 193, 243, 104, 112, 226, 154, 218, 144, 190, 70, 56, 50, 146, 115, 110, 137, 75, 255, 246, 114, 217, 137, 68, 75, 80, 81, 229, 52, 164, 177, 246, 219, 227, 192, 188, 88, 26, 50, 183, 177, 118, 7, 14, 222, 18, 214, 154, 63, 234, 33, 27, 102, 231, 82, 207, 125, 209, 221, 9, 95, 111, 19, 112, 244, 23, 8, 67, 217, 220, 16, 1, 33, 228, 207, 99, 1, 40, 9, 102, 68, 135, 201, 121, 98, 132, 48, 77, 197, 63, 244, 163, 66, 48, 64, 48, 15, 6, 3, 85, 29, 19, 1, 1, 255, 4, 5, 48, 3, 1, 1, 255, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 144, 37, 181, 13, 217, 5, 71, 231, 150, 195, 150, 250, 114, 157, 207, 153, 169, 223, 75, 150, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, 163, 127, 47, 145, 161, 201, 189, 94, 231, 184, 98, 124, 22, 152, 210, 85, 3, 142, 31, 3, 67, 249, 91, 99, 169, 98, 140, 61, 57, 128, 149, 69, 161, 30, 188, 191, 46, 59, 85, 216, 174, 238, 113, 180, 195, 214, 173, 243, 2, 49, 0, 162, 243, 155, 22, 5, 178, 112, 40, 165, 221, 75, 160, 105, 181, 1, 110, 101, 180, 251, 222, 143, 224, 6, 29, 106, 83, 25, 127, 156, 218, 245, 217, 67, 188, 97, 252, 43, 235, 3, 203, 111, 238, 141, 35, 2, 243, 223, 246, 89, 2, 194, 48, 130, 2, 190, 48, 130, 2, 68, 160, 3, 2, 1, 2, 2, 16, 72, 89, 143, 129, 178, 119, 228, 126, 214, 78, 90, 102, 147, 77, 205, 244, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 50, 48, 52, 48, 49, 49, 56, 50, 49, 48, 48, 90, 23, 13, 50, 50, 48, 52, 50, 49, 49, 57, 50, 49, 48, 48, 90, 48, 100, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 54, 48, 52, 6, 3, 85, 4, 3, 12, 45, 97, 100, 55, 57, 56, 51, 102, 54, 52, 54, 101, 102, 99, 55, 99, 52, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 208, 176, 163, 110, 108, 115, 193, 184, 155, 197, 161, 174, 37, 82, 77, 197, 158, 196, 54, 39, 223, 172, 156, 226, 57, 60, 56, 30, 176, 3, 79, 117, 148, 80, 101, 50, 56, 194, 72, 20, 57, 171, 234, 82, 102, 139, 209, 66, 80, 48, 205, 251, 163, 58, 73, 170, 97, 246, 50, 184, 254, 49, 211, 31, 133, 236, 20, 207, 4, 99, 124, 220, 244, 154, 253, 36, 217, 235, 7, 189, 240, 88, 74, 242, 224, 175, 12, 92, 81, 1, 27, 152, 47, 183, 129, 97, 163, 129, 213, 48, 129, 210, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 2, 48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, 128, 20, 144, 37, 181, 13, 217, 5, 71, 231, 150, 195, 150, 250, 114, 157, 207, 153, 169, 223, 75, 150, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 28, 10, 15, 237, 31, 28, 72, 150, 205, 213, 166, 69, 32, 119, 83, 121, 17, 152, 115, 78, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 108, 6, 3, 85, 29, 31, 4, 101, 48, 99, 48, 97, 160, 95, 160, 93, 134, 91, 104, 116, 116, 112, 58, 47, 47, 97, 119, 115, 45, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 45, 99, 114, 108, 46, 115, 51, 46, 97, 109, 97, 122, 111, 110, 97, 119, 115, 46, 99, 111, 109, 47, 99, 114, 108, 47, 97, 98, 52, 57, 54, 48, 99, 99, 45, 55, 100, 54, 51, 45, 52, 50, 98, 100, 45, 57, 101, 57, 102, 45, 53, 57, 51, 51, 56, 99, 98, 54, 55, 102, 56, 52, 46, 99, 114, 108, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 104, 0, 48, 101, 2, 48, 106, 211, 175, 216, 63, 62, 72, 73, 142, 39, 121, 20, 33, 222, 223, 121, 151, 134, 7, 117, 20, 112, 132, 242, 57, 91, 150, 26, 127, 95, 156, 166, 76, 83, 190, 152, 41, 202, 223, 254, 123, 26, 30, 167, 82, 105, 215, 9, 2, 49, 0, 209, 82, 146, 16, 174, 248, 20, 169, 13, 77, 209, 69, 211, 88, 4, 29, 45, 240, 37, 222, 205, 84, 166, 4, 78, 54, 161, 163, 31, 0, 58, 192, 174, 36, 38, 160, 251, 212, 36, 232, 153, 238, 0, 197, 58, 112, 93, 171, 89, 3, 25, 48, 130, 3, 21, 48, 130, 2, 154, 160, 3, 2, 1, 2, 2, 17, 0, 222, 148, 242, 104, 194, 226, 150, 194, 227, 115, 158, 147, 231, 19, 174, 123, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 100, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 54, 48, 52, 6, 3, 85, 4, 3, 12, 45, 97, 100, 55, 57, 56, 51, 102, 54, 52, 54, 101, 102, 99, 55, 99, 52, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 50, 48, 52, 48, 54, 49, 49, 53, 50, 52, 57, 90, 23, 13, 50, 50, 48, 52, 49, 50, 48, 48, 53, 50, 52, 56, 90, 48, 129, 136, 49, 59, 48, 57, 6, 3, 85, 4, 3, 12, 50, 49, 56, 97, 51, 54, 97, 49, 50, 57, 98, 56, 51, 99, 97, 55, 46, 122, 111, 110, 97, 108, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 11, 48, 9, 6, 3, 85, 4, 8, 12, 2, 87, 65, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 172, 35, 105, 154, 147, 246, 60, 181, 216, 195, 255, 153, 46, 212, 45, 185, 94, 181, 189, 49, 216, 17, 101, 121, 54, 115, 109, 44, 131, 248, 123, 116, 193, 30, 1, 86, 28, 218, 32, 101, 64, 252, 22, 19, 164, 168, 116, 91, 20, 18, 161, 157, 105, 135, 95, 183, 18, 104, 5, 41, 1, 123, 109, 25, 197, 147, 56, 65, 153, 67, 9, 155, 23, 143, 20, 108, 139, 105, 103, 124, 161, 46, 18, 179, 120, 107, 8, 226, 79, 212, 67, 205, 110, 131, 14, 178, 163, 129, 234, 48, 129, 231, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 1, 48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, 128, 20, 28, 10, 15, 237, 31, 28, 72, 150, 205, 213, 166, 69, 32, 119, 83, 121, 17, 152, 115, 78, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 236, 82, 162, 207, 114, 141, 251, 199, 145, 223, 107, 46, 170, 164, 85, 0, 218, 12, 189, 241, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 129, 128, 6, 3, 85, 29, 31, 4, 121, 48, 119, 48, 117, 160, 115, 160, 113, 134, 111, 104, 116, 116, 112, 58, 47, 47, 99, 114, 108, 45, 117, 115, 45, 101, 97, 115, 116, 45, 50, 45, 97, 119, 115, 45, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 46, 115, 51, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 109, 97, 122, 111, 110, 97, 119, 115, 46, 99, 111, 109, 47, 99, 114, 108, 47, 53, 50, 98, 99, 99, 99, 54, 56, 45, 56, 55, 101, 55, 45, 52, 101, 97, 51, 45, 56, 52, 101, 57, 45, 48, 48, 56, 99, 52, 55, 98, 51, 97, 55, 49, 55, 46, 99, 114, 108, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, 214, 22, 40, 244, 26, 215, 178, 160, 195, 116, 198, 115, 241, 48, 23, 254, 230, 92, 114, 145, 125, 161, 71, 46, 144, 217, 83, 60, 228, 216, 96, 109, 83, 183, 123, 197, 197, 14, 132, 175, 213, 94, 114, 120, 102, 62, 109, 190, 2, 49, 0, 151, 241, 205, 24, 126, 45, 131, 33, 52, 168, 33, 42, 141, 199, 255, 40, 121, 244, 109, 83, 39, 69, 216, 59, 211, 41, 162, 45, 89, 142, 185, 116, 211, 244, 79, 42, 135, 62, 131, 153, 78, 155, 236, 249, 88, 202, 237, 29, 89, 2, 131, 48, 130, 2, 127, 48, 130, 2, 4, 160, 3, 2, 1, 2, 2, 21, 0, 230, 104, 80, 254, 152, 182, 253, 153, 100, 17, 158, 253, 28, 72, 5, 192, 170, 214, 81, 66, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 129, 136, 49, 59, 48, 57, 6, 3, 85, 4, 3, 12, 50, 49, 56, 97, 51, 54, 97, 49, 50, 57, 98, 56, 51, 99, 97, 55, 46, 122, 111, 110, 97, 108, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 11, 48, 9, 6, 3, 85, 4, 8, 12, 2, 87, 65, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 48, 30, 23, 13, 50, 50, 48, 52, 48, 54, 49, 56, 49, 57, 50, 49, 90, 23, 13, 50, 50, 48, 52, 48, 55, 49, 56, 49, 57, 50, 49, 90, 48, 129, 142, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 57, 48, 55, 6, 3, 85, 4, 3, 12, 48, 105, 45, 48, 98, 48, 54, 54, 55, 55, 52, 53, 54, 52, 53, 50, 97, 52, 57, 97, 46, 117, 115, 45, 101, 97, 115, 116, 45, 50, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 134, 243, 71, 0, 28, 58, 163, 83, 12, 233, 154, 127, 192, 39, 88, 185, 172, 215, 71, 77, 95, 234, 251, 24, 224, 172, 218, 219, 201, 76, 220, 140, 75, 158, 185, 40, 166, 53, 16, 8, 133, 152, 33, 217, 78, 220, 100, 108, 21, 131, 228, 237, 138, 172, 62, 92, 81, 177, 91, 110, 125, 37, 247, 251, 6, 96, 77, 102, 35, 46, 52, 222, 242, 48, 244, 190, 166, 36, 76, 20, 150, 183, 77, 8, 190, 148, 68, 167, 57, 31, 33, 3, 19, 130, 71, 22, 163, 38, 48, 36, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 0, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 2, 4, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, 192, 185, 177, 42, 96, 22, 149, 171, 223, 240, 71, 3, 253, 251, 58, 50, 82, 240, 194, 83, 109, 114, 12, 2, 244, 6, 5, 161, 253, 42, 120, 34, 160, 44, 41, 214, 198, 131, 240, 201, 107, 12, 204, 134, 216, 83, 240, 204, 2, 49, 0, 131, 101, 66, 223, 42, 100, 24, 185, 125, 108, 118, 30, 196, 140, 40, 198, 118, 152, 48, 113, 120, 212, 1, 96, 76, 9, 99, 214, 163, 200, 240, 125, 30, 53, 225, 66, 219, 5, 115, 198, 71, 119, 104, 114, 94, 33, 149, 135, 106, 112, 117, 98, 108, 105, 99, 95, 107, 101, 121, 83, 109, 121, 32, 115, 117, 112, 101, 114, 32, 115, 101, 99, 114, 101, 116, 32, 107, 101, 121, 105, 117, 115, 101, 114, 95, 100, 97, 116, 97, 77, 104, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100, 33, 101, 110, 111, 110, 99, 101, 65, 49, 88, 96, 207, 144, 173, 186, 239, 138, 254, 94, 148, 30, 111, 90, 98, 203, 132, 239, 42, 137, 106, 10, 142, 5, 28, 247, 163, 151, 249, 166, 97, 17, 4, 91, 114, 133, 52, 215, 198, 211, 33, 33, 10, 174, 208, 98, 95, 141, 104, 229, 131, 129, 85, 84, 36, 32, 78, 162, 102, 43, 136, 171, 126, 200, 67, 37, 242, 205, 189, 220, 3, 222, 250, 183, 23, 64, 168, 147, 126, 94, 224, 54, 147, 229, 18, 93, 77, 99, 51, 76, 56, 113, 187, 204, 26, 218, 97, 63];
    let res:Response = from_slice(&b).unwrap();
    let doc = resolve_the_response_doc(res).unwrap();
    println!("{:?}",doc.len());
    println!("{:?}",doc);
}